# ============================================
# Clawdbot ä¸»é…ç½®æ–‡ä»¶
# åŸŸå: clawdbot.cyberoracle.net
# ============================================

# --------------------------------------------
# ä¼šè¯é…ç½® (å¤šç”¨æˆ·éš”ç¦»)
# --------------------------------------------
session:
  # per-channel-peer: æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹ä¼šè¯
  dmScope: "per-channel-peer"

# --------------------------------------------
# Agent é…ç½®
# --------------------------------------------
agents:
  defaults:
    # é»˜è®¤æ¨¡å‹é…ç½®
    model:
      primary: "minimax/MiniMax-M2.1"
      fallbacks:
        - "google/gemini-2.0-flash"
        - "deepseek/deepseek-chat"

    # æ¨¡å‹ç™½åå• + åˆ«å (ç”¨äº /model åˆ‡æ¢)
    models:
      # MiniMax ç³»åˆ—
      "minimax/MiniMax-M2.1":
        alias: "minimax"
      "minimax/MiniMax-M2.1-lightning":
        alias: "minimax-fast"

      # Google Gemini ç³»åˆ—
      "google/gemini-2.0-flash":
        alias: "gemini"
      "google/gemini-2.5-pro-preview":
        alias: "gemini-pro"
      "google/gemini-2.5-flash-preview":
        alias: "gemini-flash"

      # DeepSeek ç³»åˆ—
      "deepseek/deepseek-chat":
        alias: "deepseek"
      "deepseek/deepseek-reasoner":
        alias: "deepseek-r1"

  # æ¯ç”¨æˆ·ç‹¬ç«‹ agent
  list:
    - id: "user1"
      name: "Kyle"
      workspace: "~/clawd-user1"
      default: true
    - id: "user2"
      name: "Jack"
      workspace: "~/clawd-user2"
    - id: "user3"
      name: "Jing"
      workspace: "~/clawd-user3"

# --------------------------------------------
# è·¯ç”±ç»‘å®š (TG User ID â†’ Agent)
# --------------------------------------------
bindings:
  - agentId: "user1"
    match:
      channel: "telegram"
      peer:
        kind: "dm"
        id: "6309937609"
  - agentId: "user2"
    match:
      channel: "telegram"
      peer:
        kind: "dm"
        id: "8412468762"
  - agentId: "user3"
    match:
      channel: "telegram"
      peer:
        kind: "dm"
        id: "7121639624"

  # WhatsApp ç»‘å®š
  - agentId: "user1"
    match:
      channel: "whatsapp"
      peer:
        kind: "dm"
        id: "+61459188816" # Kyle æ‰‹æœºå·ï¼ˆè¯·æ›¿æ¢ï¼‰
  # - agentId: "user2"
  #   match:
  #     channel: "whatsapp"
  #     peer:
  #       kind: "dm"
  #       id: ""    # Jack æ‰‹æœºå·ï¼ˆå¾…å¡«ï¼‰
  - agentId: "user3"
    match:
      channel: "whatsapp"
      peer:
        kind: "dm"
        id: "+61452608816" # Jing æ‰‹æœºå·ï¼ˆè¯·æ›¿æ¢ï¼‰

# --------------------------------------------
# æ¨¡å‹ Provider é…ç½®
# --------------------------------------------
models:
  mode: "merge"
  providers:
    # MiniMax é…ç½®
    minimax:
      baseUrl: "https://api.minimax.io/anthropic"
      apiKey: "${MINIMAX_API_KEY}"
      api: "anthropic-messages"
      models:
        - id: "MiniMax-M2.1"
          name: "MiniMax M2.1"
          reasoning: false
          input: ["text"]
          cost:
            input: 15
            output: 60
            cacheRead: 2
            cacheWrite: 10
          contextWindow: 200000
          maxTokens: 8192
        - id: "MiniMax-M2.1-lightning"
          name: "MiniMax M2.1 Lightning"
          reasoning: false
          input: ["text"]
          cost:
            input: 15
            output: 90
          contextWindow: 200000
          maxTokens: 8192

    # DeepSeek é…ç½® (OpenAI å…¼å®¹)
    deepseek:
      baseUrl: "https://api.deepseek.com/v1"
      apiKey: "${DEEPSEEK_API_KEY}"
      api: "openai-completions"
      models:
        - id: "deepseek-chat"
          name: "DeepSeek V3"
          reasoning: false
          input: ["text"]
          cost:
            input: 0.27
            output: 1.10
          contextWindow: 64000
          maxTokens: 8192
        - id: "deepseek-reasoner"
          name: "DeepSeek R1"
          reasoning: true
          input: ["text"]
          cost:
            input: 0.55
            output: 2.19
          contextWindow: 64000
          maxTokens: 8192

    # Google Gemini (åŸç”Ÿæ”¯æŒï¼Œåªéœ€ API Key)
    google:
      apiKey: "${GOOGLE_API_KEY}"

# --------------------------------------------
# Telegram é¢‘é“é…ç½®
# --------------------------------------------
channels:
  telegram:
    enabled: true
    botToken: "${TELEGRAM_BOT_TOKEN}"

    # DM è®¿é—®ç­–ç•¥: allowlist = ä»…ç™½åå•ç”¨æˆ·
    dmPolicy: "allowlist"

    # æˆæƒç”¨æˆ·åˆ—è¡¨ (Telegram User ID)
    # è·å–æ–¹æ³•: DM ä½ çš„ botï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­çš„ from.id
    # æˆ–è€… DM @userinfobot è·å–ä½ çš„ ID
    allowFrom:
      - "6309937609" # Kyle
      - "8412468762" # Jack
      - "7121639624" # Jing

    # ç¾¤ç»„ç­–ç•¥ (å¯é€‰)
    groupPolicy: "disabled" # æš‚æ—¶ç¦ç”¨ç¾¤ç»„

    # æ¶ˆæ¯é™åˆ¶
    textChunkLimit: 4000
    mediaMaxMb: 10

  # --------------------------------------------
  # WhatsApp é¢‘é“é…ç½®
  # --------------------------------------------
  whatsapp:
    enabled: true

    # DM è®¿é—®ç­–ç•¥: allowlist = ä»…ç™½åå•ç”¨æˆ·
    dmPolicy: "allowlist"

    # æˆæƒç”¨æˆ·åˆ—è¡¨ (E.164 æ ¼å¼æ‰‹æœºå·ï¼Œå¸¦å›½å®¶ç )
    # ä¾‹å¦‚ä¸­å›½: +86..., ç¾å›½: +1...
    allowFrom:
      - "+61459188816" # Kyle
      - "+61452608816" # Jing
      # - ""              # Jackï¼ˆå¾…å¡«ï¼‰

    # ç¾¤ç»„ç­–ç•¥
    groupPolicy: "disabled"

    # å‘é€å·²è¯»å›æ‰§ï¼ˆè“è‰²åŒå‹¾ï¼‰
    sendReadReceipts: true

    # æ¶ˆæ¯é™åˆ¶
    textChunkLimit: 4000
    mediaMaxMb: 50

# --------------------------------------------
# å‘½ä»¤é…ç½®
# --------------------------------------------
commands:
  native: "auto" # è‡ªåŠ¨æ³¨å†ŒåŸç”Ÿå‘½ä»¤
  text: true # å¯ç”¨æ–‡æœ¬å‘½ä»¤
  config: false # ç¦ç”¨ /config (å®‰å…¨)
  debug: false # ç¦ç”¨ /debug (å®‰å…¨)

# --------------------------------------------
# æ¶ˆæ¯é…ç½®
# --------------------------------------------
messages:
  # å¯é€‰: æ·»åŠ å“åº”å‰ç¼€
  # responsePrefix: "[CyberOracle]"

  # ç¾¤èŠå†å²é™åˆ¶
  groupChat:
    historyLimit: 50

# --------------------------------------------
# Webhook / Gmail é…ç½®
# --------------------------------------------
hooks:
  enabled: true
  token: "${CLAWDBOT_HOOK_TOKEN}"
  path: "/hooks"
  presets: ["gmail"]

  # Gmail ä¸“ç”¨é…ç½®
  gmail:
    account: "${GMAIL_ACCOUNT}" # Jing çš„ Gmail åœ°å€
    model: "google/gemini-2.0-flash" # Gmail å¤„ç†ç”¨ä½æˆæœ¬æ¨¡å‹
    thinking: "off"

  # è·¯ç”±æ˜ å°„
  mappings:
    # Jing çš„ Gmail â†’ Telegram é€šçŸ¥
    - match: { path: "gmail" }
      action: "agent"
      agentId: "user3" # ç»‘å®šåˆ° Jing çš„ agent
      wakeMode: "now"
      name: "Gmail"
      sessionKey: "hook:gmail:{{messages[0].id}}"
      messageTemplate: |
        ğŸ“§ æ–°é‚®ä»¶
        å‘ä»¶äºº: {{messages[0].from}}
        ä¸»é¢˜: {{messages[0].subject}}
        ---
        {{messages[0].snippet}}
      deliver: true
      channel: "telegram"
      to: "7121639624" # Jing çš„ TG ID
